

# 分布式系统的8个谬误

* [原文链接](https://architecturenotes.co/fallacies-of-distributed-systems/)


## 概述
* 该谬误是一份用于断言集，描述了分布式系统的新开发者经常会做出的错误假设的
* 微系统的大量采用迫使更多的工程师去理解他们系统中各种决定的影响
* 当讨论系统设计时，以下8个谬误是最常被忽略或轻视的


![](http://picbed.cc12703.com/20221230153304.png)



## 网络是可靠的

* 为了构建可靠的系统，需要了解以下事实：任何特定的通信都会失效。
* 需要给系统提供一种处理潜在通信错误的方法：归根到底就是一种重试机制
* "存储转发"模式：将数据存储在本地，而不是直接将数据发送给下流服务器


## 时延是零

* 时延对于完成任何请求来说都是一种开销，消息可大可小，但是时延是不变的
* 不像带宽，时延经常与通信距离和光速相关，所以两个系统之间的距离是一个重要的因素
* 时延是普遍的，存在于任何通信过程中
* 理想情况下，时延开销是余越小越好。时延非常类似于从车上卸货的过程，将货物从厨房运到车上花的时间就是时延


### CDN是什么
* CDN（内容分发网络）是指一组共同工作的地理上分散的服务器，提供了对互联网上内容快速分发的功能
* CDN允许快速的传输需要资产：html页面，js脚本、样式表、图片、视频

* CDN和边缘计算本质上就是将冰箱和运输管道之间的距离尽可能的缩短
* 通过将数据复制到离需要的地方尽可能的近，就可以显著地降低时延



## 带宽是无限的

* 假设在一个渠道上可以无限制的增加数据大小，是十分错误的
    * 这种问题只有在规模扩大时，或者特定通信渠道到达限制时才会出现


## 网络是安全的

* 以下假设会是一个严重的错误
    * 假设你可以信任你所使用的网络
    * 假设你可以信任构建系统的人员
* 如今从包漏洞赏金计划和重大漏洞利用越来越常见
* 在设计系统时采用安全优先的策略会使你在未来获取到红利
* 甚至花点时间对当前系统的安全性和漏洞进行评估也是一个很好的起点
    * 会快速的产生一个系统提升清单


## 拓扑是不变的

* 网络结构不会一直都是一样的。
* 随着Docker和K8S的出现，改变网络拓扑的方便性几乎使我们将其视为理所当然，这是很危险的

* 像Zookeeper和Consul之类的工具确实解决了服务发现的问题，允许应用对于系统布局的改变做出响应
* 构建可以对拓扑改变做出响应的系统是比较棘手的，但是最终的效果会使系统更具弹性


## 只有一个管理员

* 这个点需要我们化点时间来理解，本质上是指你无法控制系统的全部
* 随着系统的变大，系统将会依赖于你无法控制的外部系统
    * 所以请化点时间来思考系统所有的依赖，从你的代码到运行代码的服务器
* 使用一种干净的方法来管理系统并且各个部分独立配置是非常必要的
    * 随着带有各种不同配置的系统数量的增加，系统会变的难于管理和跟踪
    * IaC（基础设施即代码）可以帮助组织管理系统中的这些不同配置

### 基础设施即代码
* IaC是通过代码而不是手动操作来管理和准备基础设施
* 在IaC中，包含基础设施规范的配置文件会被创建
    * 这样会使编辑和描述配置更容易
    * 这样会确保每次提供的环境都是一样的


## 运输成本是零

* 我们经常认为系统之间传输的数据的经营成本很低
    * 当系统很小时，这些费用和成本是可以忽略不计的
    * 随着系统变大，将JSON格式优化为gRPC或MessagePack格式是值得的


## 网络是均质的

