


# 参考_工作流语法

* [原始文档](https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions)



## 概述
* 工作流文件使用yaml语法，必须使用`.yml`或`.yaml`文件后缀
* 工作流文件必须保存在仓库的`.github/workflows`目录下




## 关键字

### name
* 工作流的名字
* GitHub会在仓库的Actions页面显示该名字
* 如果你未设置，GitHub会设置成工作流文件的相对路径


### on
* 必填，触发工作流的GitHub事件名字
* 你可以提供字符串表示单一事件、一个数组表示多个事件、一个数组表示事件的多个类型、一个有配置信息的事件（调度工作流、或限制工作流在特定文件、标签、分支上的运行）

#### 例子

##### 单一事件
```yml
# 当代码被推送到仓库的任何一个分支时触发工作流
on: push
```

##### 一组事件
```yml
# 当发生push 或 pull请求 事件时触发工作流
on: [push, pull_request]
```

##### 多个带活动类型的事件
```yml
on:
  # 当只对主分支进行push或pull请求时，触发工作流
  push:
    branches:
      - main
  pull_request:
    branches:
      - main
  # 当发生page_build事件、或发布信息被创建时，也触发工作流
  page_build:
  release:
    types: # 该配置不会影响page_build事件 
      - created
```

### on.<event_name>.types
* 选择活动类型来触发工作流运行
* 大部分GitHub事件都会被多个活动类型触发
	* 当资源被 发布、撤销、创建、编辑、删除、预发布时，发布资源的事件就会被触发
* 关键字types用于限制触发工作流运行的活动
	* 当活动只有一个类型时，types就可以不需要

#### 示例
```yml
# pull请求发生时触发工作流
on:
  release:
	# 使用types来限制触发工作流的活动类型
    types: [published, created, edited]
```


### on.<push|pull_request>.<branchs|tags>
* 当使用push和pull_request事件时，你可以指定运行在哪个分支和标签上
* 对于pull_request事件，只有基准上的分支和标签才能被求值
	* 如果值定义了`tags`和`branches`，对于影响未定义的Git ref是不会触发工作流运行的
* 关键字`branches`,`branches-ignore`,`tags`,`tags-ignore`接受GLOB模式
	* 使用`*`和`**`通配符来匹配多个分支和标签名

#### 例子

##### 包含分支和标签
```yml
on:
  push:
	# 匹配refs/heads的模式序列
    branches:    
	  # push到main分支
      - main
	  # push到匹配refs/heads/mona/octocat的分支
      - 'mona/octocat'
	  # push到匹配refs/heads/releases/10的分支
      - 'releases/**'
	# 匹配refs/tags的模式序列
    tags:        
      - v1            # push到v1标签 
      - v1.*          # push到v1.0, v1.1, v1.9标签 
```

##### 忽略分支和标签
* 任何时候匹配到branches-ignore或tags-ignore模式，都不会触发工作流运行
```yml
on:
  push:
	# 匹配refs/heads的模式序列
    branches-ignore:
	  # push到匹配refs/heads/mona/octocat的分支
      - 'mona/octocat'
	  # push到匹配refs/heads/releases/beta/3-alpha的分支
      - 'releases/**-alpha'
	# 匹配refs/tags的模式序列
    tags-ignore:
      - v1.*           # push到v1.0, v1.1, v1.9标签 
```

##### 排除分支和标签
